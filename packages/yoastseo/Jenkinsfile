podTemplate(
	containers: [
		containerTemplate(
			name: 'node',
			image: 'node:12',
			ttyEnabled: true,
			envVars: [
			    envVar(key: 'CI', value: 'true')
			]
		)
	],
	volumes: [
   		emptyDirVolume(mountPath: '/var/www/html', memory: false),
	]
) {
	node(POD_LABEL) {
		stage('Run shell') {
			container('node') {
				checkout scm
				dir( 'packages/yoastseo' ) {
				    sh 'yarn'
				    sh 'yarn lint'
				    withCredentials([gitUsernamePassword(credentialsId: '8c97ea6c-a347-40a4-b1aa-5637ba96510a', gitToolName: 'git-tool')]) {
				         sh 'yarn test'
				    }
				}
			}
		}
	}
}
